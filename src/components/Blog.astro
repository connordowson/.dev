---
import { format } from "date-fns";
import { Icon } from "astro-icon";

const blogPostsData = await Astro.glob("../pages/blog/*.md");
let blogPosts = blogPostsData.map((post) => {
  return {
    ...post,
    formattedDate: format(new Date(post.frontmatter?.date), "do MMMM, yyyy"),
  };
});
blogPosts.sort(
  (a, b) =>
    new Date(b.frontmatter.date).valueOf() -
    new Date(a.frontmatter.date).valueOf()
);
blogPosts = [...blogPosts.slice(0, 3)];
---

<section>
  <h2 class="section--heading">Blog</h2>
  <!-- <p>
    Random posts, mostly about web dev 👨‍💻, music 🎶, and anything else that I
    find interesting. <a href="./blog">View all posts</a>.
  </p> -->

  <ul>
    {
      blogPosts.map(({ frontmatter, formattedDate, url }) => {
        return (
          <li>
            <a href={url}>
              <h4>{frontmatter.title}</h4>
            </a>

            <p>{frontmatter.description}</p>
          </li>
        );
      })
    }
  </ul>
  <p><a href="./blog">View all posts</a></p>
</section>

<style lang="scss">
  ul {
    padding: 0;
    display: grid;
    gap: 1em;

    li {
      list-style-type: none;
      // padding-bottom: 0.5rem;

      a {
        text-decoration: none !important;
      }

      svg {
        margin-left: 0.25em;
        height: 22px;
        vertical-align: bottom;
      }

      h4 {
        margin: 0;
      }
    }
  }
</style>
