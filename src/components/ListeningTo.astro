---
import Section from "@components/Section.astro";
import { GET } from "../pages/api/getTopTracks";

let response = await GET(Astro);
const topTracks = await response.json();
---

<Section relative>
  <div class="flow">
    <h2>What I've been listening to</h2>
    <p>
      My top played songs from the Spotify API (so I can't hide any embarrassing
      ones).
    </p>

    <div class="grid song-card-grid">
      {
        topTracks?.length > 0 ? (
          topTracks?.map(({ name, artist, artwork }) => (
            <div class="card song-card shadow-sm">
              <img src={artwork} alt={`Album artwork for ${name}`} />

              <div class="song-card-info">
                <span class="song-card-title">{name}</span>
                <span class="song-card-artist">{artist}</span>
              </div>
            </div>
          ))
        ) : (
          <p>Loading...</p>
        )
      }
    </div>
    <!-- <svg
      version="1.1"
      id="Layer_1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      x="0px"
      y="0px"
      viewBox="0 0 412.4 267.8"
      style="enable-background:new 0 0 412.4 267.8;"
      xml:space="preserve"
      stroke-width="0.1"
      class="fill-none"
    >
      <path
        class="stroke-emerald-400/20"
        d="M228.9,267.3c-4.4,0-8.3-0.5-11.7-1c-20.8-3-37.2-14.1-45.1-30.5c-7.2-14.9-6.3-32.3,2.6-47.7
	c13.2-22.8,42-38.1,71.8-38.1c3.4,0,6.8,0.2,10,0.6l20.2-34.9l-84.3-12.3L134,204.6c-13.2,22.8-42,38.1-71.8,38.1
	c-3.9,0-7.9-0.3-11.7-0.8c-20.8-3-37.2-14.1-45.1-30.4C-1.9,196.3-1,179.4,8,163.8c13.2-22.8,42-38.1,71.8-38.1
	c3.4,0,6.8,0.2,10,0.6L162.5,0.5l249.1,36.2L300.7,229C287.7,251.5,258.2,267.3,228.9,267.3L228.9,267.3z"
      ></path>
      <path
        class="stroke-emerald-400/30"
        d="M228.9,257.3c-3.7,0-7.2-0.5-10.2-0.9c-17.4-2.5-31.1-11.6-37.6-24.9c-5.8-11.9-5-25.9,2.2-38.3
	c11.4-19.8,36.8-33.1,63.2-33.1c3.5,0,7,0.2,10.2,0.7c1.7,0.2,3.4,0.6,5,0.9l31-53.7L187.2,92.5l-61.8,107.1
	c-11.4,19.8-36.8,33.1-63.2,33.1c-3.5,0-6.9-0.2-10.2-0.7c-17.5-2.5-31.2-11.6-37.6-24.9c-5.8-12.1-5.1-25.7,2.2-38.3
	c11.4-19.8,36.8-33.1,63.2-33.1c3.5,0,6.9,0.2,10.2,0.7c1.7,0.2,3.4,0.6,5,0.9l72.7-126l227.8,33.1L292.1,224
	C280.7,243.6,254.8,257.3,228.9,257.3L228.9,257.3z"
      ></path>
      <path
        class="stroke-emerald-400/40"
        d="M228.9,247.3c-3,0-5.9-0.4-8.8-0.8c-14.1-2.1-25.1-9.2-30-19.4c-4.4-9-3.7-19.3,1.9-29
	c9.5-16.5,32-28.1,54.5-28.1c3,0,5.9,0.2,8.8,0.6c4,0.6,7.7,1.5,11.1,2.9l42.4-73.4L181.9,81.7l-65.2,112.9
	c-9.5,16.5-32,28.1-54.5,28.1c-3,0-5.9-0.2-8.8-0.6c-14.1-2.1-25.1-9.1-30-19.3c-4.4-9-3.7-19.3,1.9-28.9
	c9.5-16.5,32-28.1,54.5-28.1c3,0,5.9,0.2,8.8,0.6c4,0.6,7.7,1.6,11.1,2.9l73.3-127l206.5,30L283.4,219
	C273.8,235.6,251.4,247.3,228.9,247.3C228.9,247.3,228.9,247.3,228.9,247.3z"
      ></path>
      <path
        class="stroke-emerald-400/50"
        d="M345,57.4L196.8,35.9l-18.5-2.7l-20.2,34.9l-54.6,94.6c-4.1-3.2-9.6-5.5-16.4-6.4c-20.5-3-44.3,7.1-53.2,22.6
	s0.4,30.4,20.9,33.3c20.5,3,44.3-7.1,53.2-22.6l68.6-118.8l148.2,21.6l-54.6,94.6c-3.8-3.1-9.6-5.5-16.4-6.4
	c-20.5-3-44.3,7.1-53.2,22.6s0.4,30.4,20.9,33.3c20.5,3,44.3-7.1,53.2-22.6L343.3,95l20.2-34.9L345,57.4z"
      ></path>
    </svg> -->
  </div>
</Section>

<style lang="scss">
  svg {
    position: absolute;
    height: 230%;
    right: -700px;
    top: 50%;
    transform: translateY(-50%);
    z-index: -1;
  }
</style>
